<abp-modal
  [visible]="visible"
  (visibleChange)="onVisibleChange($event)"
  [suppressUnsavedChangesWarning]="true"
>
  <ng-template #abpHeader>
    <h5 class="modal-title">
      {{ 'AbpUi::AreYouSure' | abpLocalization }}
    </h5>
  </ng-template>

  <ng-template #abpBody>
    <p class="fw-bold">
      {{ 'AbpIdentity::RoleDeletionConfirmationMessage' | abpLocalization: name }}
    </p>
    <form [formGroup]="form" id="role-delete-form" (ngSubmit)="save()">
      @if (userCount > 0) {
        <p class="mt-2">
          {{ 'AbpIdentity::ChooseAnActionForRole' | abpLocalization: userCount }}
        </p>

        <div class="form-check mt-2">
          <input
            class="form-check-input"
            formControlName="assignType"
            type="radio"
            name="assignType"
            id="unassign"
            [value]="false"
          />
          <label class="form-check-label" for="unassign">{{
            'AbpIdentity::UnassignTheRoleFromTheUsers' | abpLocalization
          }}</label>
        </div>
        @if (roles().length > 0) {
          <div class="form-check mt-2">
            <input
              class="form-check-input"
              formControlName="assignType"
              type="radio"
              name="assignType"
              id="assign"
              [value]="true"
            />
            <label class="form-check-label" for="assign">{{
              'AbpIdentity::AssignUsersToOtherRole' | abpLocalization
            }}</label>
          </div>
          @if (assignType$ | async) {
            <select
              class="form-select mt-2"
              [ngClass]="{ 'border-danger': showAssignErrorMessage() }"
              formControlName="role"
            >
              <option [ngValue]="null" selected>
                {{
                  (loading() ? 'AbpUi::LoadingWithThreeDot' : 'AbpIdentity::SelectAnRoleToAssign')
                    | abpLocalization
                }}
              </option>
              @for (item of roles(); track $index) {
                <option [value]="item.id">
                  {{ item.name }}
                </option>
              }
            </select>
          }
          @if (showAssignErrorMessage()) {
            <span class="text-danger">
              {{ 'AbpValidation::ThisFieldIsRequired.' | abpLocalization }}
            </span>
          }
        }
      }
    </form>
  </ng-template>

  <ng-template #abpFooter>
    <button abpClose type="button" class="btn btn-outline-danger">
      {{ 'AbpUi::Cancel' | abpLocalization }}
    </button>
    <button type="submit" class="btn btn-danger" [loading]="loading()" form="role-delete-form">
      <i class="fa fa-trash" aria-hidden="true"></i>
      {{ 'AbpUi::Delete' | abpLocalization }}
    </button>
  </ng-template>
</abp-modal>
